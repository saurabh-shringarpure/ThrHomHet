(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     95457,       2476]
NotebookOptionsPosition[     90852,       2396]
NotebookOutlinePosition[     91280,       2413]
CellTagsIndexPosition[     91237,       2410]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
[Calc] Deriving this Wigner distribution using linearity of Wigner transform \
in density operators\
\>", "Subsubsection",
 CellChangeTimes->{{3.8858442332396517`*^9, 3.8858442563243732`*^9}, 
   3.885958357852479*^9, {3.8860153233031907`*^9, 3.886015338289157*^9}, {
   3.886016227230587*^9, 
   3.886016229231062*^9}},ExpressionUUID->"f2aa224e-304c-4038-8ad3-\
777e6eb4da94"],

Cell[TextData[{
 "W1ecat  = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", "Norm"], "[", 
    RowBox[{
     SubscriptBox["W", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"Coh", "."}]}]], "+", 
     SubscriptBox["W", 
      RowBox[{
       RowBox[{"-", "\[Alpha]"}], " ", ",", 
       RowBox[{"Coh", "."}]}]], "+", 
     SubscriptBox["W", 
      RowBox[{"+", "-"}]], "+", 
     SubscriptBox["W", 
      RowBox[{"-", "+"}]]}], "]"}], TraditionalForm]],ExpressionUUID->
  "876bd271-f315-44dd-bbf0-09551edfecc0"],
 "\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["W", 
     RowBox[{"+", "-"}]], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "\[Pi]"}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", "\[ImaginaryI]py"}]], 
       RowBox[{
        SubscriptBox["\[Psi]", "\[Alpha]"], "(", 
        RowBox[{"x", "+", 
         FractionBox["y", "2"]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[Psi]", 
         RowBox[{"-", "\[Alpha]"}]], "\[Conjugate]"}], 
       RowBox[{"(", 
        RowBox[{"x", "-", 
         FractionBox["y", "2"]}], ")"}], " ", 
       RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"b5515b7f-1bfa-4b6e-b698-aac3402fd86f"],
 " (Wikipedia convention)"
}], "Text",
 CellChangeTimes->{{3.8858442584345074`*^9, 3.8858444379806347`*^9}, {
  3.8870657390380993`*^9, 
  3.8870657450767207`*^9}},ExpressionUUID->"46b17cec-0e35-4f06-a977-\
0f19b218036d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]", "[", 
     RowBox[{"x0_", ",", "p0_", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["\[Pi]", 
       RowBox[{"1", "/", "4"}]]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "p0", " ", "x"}]], 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", " ", "x0"}], ")"}], "2"]}], "2"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "x0", " ", "p0"}], "2"], " "}]]}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Coherent", " ", "state", " ", "wave", " ", "function"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"For", " ", 
     RowBox[{"conjugate", ":", " ", 
      RowBox[{"use", " ", 
       RowBox[{"\[Psi]", "\[Conjugate]"}], 
       RowBox[{"(", 
        RowBox[{"x0", ",", 
         RowBox[{"p0", ";", "x"}]}], ")"}]}]}]}], "->", " ", 
    RowBox[{"\[Psi]", 
     RowBox[{"(", 
      RowBox[{"x0", ",", 
       RowBox[{
        RowBox[{"-", "p0"}], ";", "x"}]}], ")"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ws1s2", "[", 
    RowBox[{
    "\[Alpha]_", ",", "\[Theta]_", ",", "x_", ",", "p_", ",", "s1_", ",", 
     "s2_"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "\[Pi]"}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "p", " ", "y"}]], 
       RowBox[{"\[Psi]", "[", 
        RowBox[{
         RowBox[{"s1", 
          SqrtBox["2"], "\[Alpha]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"s1", 
          SqrtBox["2"], "\[Alpha]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"x", "+", 
          RowBox[{"y", "/", "2"}]}]}], "]"}], 
       RowBox[{"\[Psi]", "[", 
        RowBox[{
         RowBox[{"s2", " ", 
          SqrtBox["2"], "\[Alpha]", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "s2"}], 
          SqrtBox["2"], "\[Alpha]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"x", "-", 
          RowBox[{"y", "/", "2"}]}]}], "]"}], 
       RowBox[{"\[DifferentialD]", "y"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Ws1s2", "[", 
  RowBox[{
  "\[Alpha]", ",", "\[Theta]", ",", "x", ",", "p", ",", "1", ",", "1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Ws1s2", "[", 
  RowBox[{"\[Alpha]", ",", "\[Theta]", ",", "x", ",", "p", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8858445272544684`*^9, 3.8858446411380873`*^9}, {
  3.8858450865120754`*^9, 3.885845106514455*^9}, {3.88584516037786*^9, 
  3.885845195051381*^9}, {3.8858633420386705`*^9, 3.885863439685955*^9}, {
  3.885863494205274*^9, 3.885863547600296*^9}, {3.8860152650006094`*^9, 
  3.886015273361849*^9}, {3.886270604508871*^9, 3.886270612267581*^9}, {
  3.8862706532507887`*^9, 3.886270695605191*^9}, {3.886270733490753*^9, 
  3.88627080869214*^9}, {3.8870631489618716`*^9, 3.8870632152175474`*^9}, {
  3.8870658093364015`*^9, 3.8870658178814464`*^9}, {3.8870661649961452`*^9, 
  3.887066192785466*^9}, {3.887069977411128*^9, 3.8870699962380238`*^9}, {
  3.8940653598649006`*^9, 3.894065387536829*^9}, {3.8940654398040466`*^9, 
  3.8940654791754847`*^9}, {3.894065518974456*^9, 3.8940655213143654`*^9}, {
  3.8940658394344187`*^9, 
  3.894065846639325*^9}},ExpressionUUID->"50b1cce2-e8e2-40fc-a557-\
9cef5648ed5f"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["p", "2"]}], "-", 
    SuperscriptBox["x", "2"], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[Alpha]", "2"]}], "+", 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", "\[Alpha]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"p", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], 
  "\[Pi]"]], "Output",
 CellChangeTimes->{
  3.8858495712551374`*^9, 3.885863443295351*^9, 3.885863500549529*^9, 
   3.885863620103553*^9, 3.885863742355462*^9, 3.8858640410613513`*^9, {
   3.8862707820095177`*^9, 3.8862708114531307`*^9}, 3.887063268260765*^9, 
   3.887066201235404*^9, 3.8870700127644434`*^9, {3.8940654865416145`*^9, 
   3.894065490573142*^9}, 3.8940655282744894`*^9, 3.894065797187976*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"7d50bf4c-d6b9-4598-9bd8-45f07d8acafb"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["p", "2"]}], "-", 
    SuperscriptBox["x", "2"], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[Alpha]", "2"]}], "-", 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", "\[Alpha]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"p", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], 
  "\[Pi]"]], "Output",
 CellChangeTimes->{
  3.8858495712551374`*^9, 3.885863443295351*^9, 3.885863500549529*^9, 
   3.885863620103553*^9, 3.885863742355462*^9, 3.8858640410613513`*^9, {
   3.8862707820095177`*^9, 3.8862708114531307`*^9}, 3.887063268260765*^9, 
   3.887066201235404*^9, 3.8870700127644434`*^9, {3.8940654865416145`*^9, 
   3.894065490573142*^9}, 3.8940655282744894`*^9, 3.894065800409297*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"ae6fc8dc-73ff-4c95-9a78-1bdaa31b4887"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Ws1s2", "[", 
     RowBox[{
     "\[Alpha]", ",", "\[Theta]", ",", "x", ",", "p", ",", "1", ",", "1"}], 
     "]"}], "+", 
    RowBox[{"Ws1s2", "[", 
     RowBox[{"\[Alpha]", ",", "\[Theta]", ",", "x", ",", "p", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ")"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Ws1s2", "[", 
     RowBox[{"\[Alpha]", ",", "\[Theta]", ",", "x", ",", "p", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "]"}], "+", 
    RowBox[{"Ws1s2", "[", 
     RowBox[{"\[Alpha]", ",", "\[Theta]", ",", "x", ",", "p", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.885844956662285*^9, 3.8858449582872663`*^9}, {
  3.885845054196477*^9, 3.8858450791517572`*^9}, {3.885845118499655*^9, 
  3.8858451521119704`*^9}, {3.885845251590592*^9, 3.8858453032686176`*^9}, {
  3.8858453432712803`*^9, 3.885845351132615*^9}, {3.8858454149330425`*^9, 
  3.885845423089411*^9}, {3.88586376026349*^9, 3.8858637608881693`*^9}, {
  3.886271006916383*^9, 3.8862710310173817`*^9}, {3.887063233879213*^9, 
  3.887063251222247*^9}, {3.8870700285839963`*^9, 3.8870700423994083`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3fe25f4f-508b-4882-88fe-1adf628f284a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p", "2"]}], "-", 
     SuperscriptBox["x", "2"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[Alpha]", "2"]}]}]], " ", 
   RowBox[{"Cosh", "[", 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", "\[Alpha]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
       RowBox[{"p", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}], 
  "\[Pi]"]], "Output",
 CellChangeTimes->{
  3.8858452678267856`*^9, 3.8858453051123543`*^9, 3.8858453525245996`*^9, 
   3.8858454251830435`*^9, {3.8858635147541895`*^9, 3.8858635168166904`*^9}, {
   3.885863758247554*^9, 3.8858637616069584`*^9}, 3.886270827921177*^9, 
   3.886271032191574*^9, 3.887063289865644*^9, 3.887066211464847*^9, 
   3.8870700496199336`*^9, 3.8940655587516975`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"e9010df4-fc11-4eb6-91ee-03296a595ce5"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p", "2"]}], "-", 
     SuperscriptBox["x", "2"]}]], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", "\[Alpha]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
       RowBox[{"x", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}], 
  "\[Pi]"]], "Output",
 CellChangeTimes->{
  3.8858452678267856`*^9, 3.8858453051123543`*^9, 3.8858453525245996`*^9, 
   3.8858454251830435`*^9, {3.8858635147541895`*^9, 3.8858635168166904`*^9}, {
   3.885863758247554*^9, 3.8858637616069584`*^9}, 3.886270827921177*^9, 
   3.886271032191574*^9, 3.887063289865644*^9, 3.887066211464847*^9, 
   3.8870700496199336`*^9, 3.8940655650430517`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"1cb837f3-40a3-47ac-9708-6c9651d0e735"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Wcat", "[", 
    RowBox[{"\[Alpha]_", ",", "\[Theta]_", ",", "x_", ",", "p_", ",", "s_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["p", "2"]}], "-", 
          SuperscriptBox["x", "2"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Alpha]", "2"]}]}]], " ", 
        RowBox[{"Cosh", "[", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"p", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}], 
       "\[Pi]"], "+", 
      RowBox[{"s", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["p", "2"]}], "-", 
           SuperscriptBox["x", "2"]}]], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
             RowBox[{"x", " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}], 
        "\[Pi]"]}]}], ")"}], 
    FractionBox["1", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"s", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["\[Alpha]", "2"]}]]}]}], ")"}]}]]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8870860667295227`*^9, 3.887086185425682*^9}, {
  3.8940655748266354`*^9, 3.8940655784259624`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"354ff959-f72f-4056-b5ac-6a6edfd5dcfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
[Calc] Finding the Wigner distribution after homodyne heralding\
\>", "Subsubsection",
 CellChangeTimes->{{3.885846498092421*^9, 3.885846501514296*^9}, {
   3.8860150383632526`*^9, 3.8860150475356274`*^9}, {3.886015085678426*^9, 
   3.886015105524132*^9}, {3.886015427936349*^9, 3.8860154304678*^9}, 
   3.886015466750798*^9, {3.8871575055668015`*^9, 3.887157506546286*^9}, {
   3.894065778614628*^9, 
   3.8940657798717256`*^9}},ExpressionUUID->"7990f718-9d32-43ed-a38e-\
8388a77ea3ed"],

Cell[BoxData[
 RowBox[{"(*", " ", "\[IndentingNewLine]", "   ", 
  RowBox[{
   RowBox[{"For", " ", "the", " ", "current", " ", "example"}], ",", " ", 
   RowBox[{
    RowBox[{"Wigner", " ", "distribution", " ", "has", " ", "a", " ", 
     RowBox[{"form", ":", " ", 
      SuperscriptBox["W", 
       RowBox[{"(", "2", ")"}]]}]}], "=", 
    RowBox[{
     FractionBox["1", "\[ScriptCapitalN]"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["W", "++"], "+", 
        SubscriptBox["W", "--"], "+", 
        SubscriptBox["W", 
         RowBox[{"+", "-"}]], "+", 
        SubscriptBox["W", 
         RowBox[{"-", "+"}]]}], ")"}], ".", "\[IndentingNewLine]", 
      "First"}]}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "are", " ", "interested", " ", "in", " ", "finding", " ", 
     SubscriptBox["W", 
      RowBox[{"++", 
       RowBox[{",", 
        RowBox[{"--", 
         RowBox[{",", 
          RowBox[{"+", "-"}], ",", "--"}]}]}]}]], " ", 
     RowBox[{
     "separately", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      "Careful"}], " ", "about", " ", "using", " ", "the", " ", 
     "wavefunction", " ", "for", " ", "coherent", " ", "state", " ", 
     RowBox[{"here", ".", " ", "Imaginary"}], " ", "part", " ", 
     "\[ImaginaryI]r\[Alpha]", " ", "is", " ", 
     RowBox[{"important", ".", "\[IndentingNewLine]", " ", "For"}], " ", 
     RowBox[{"conjugate", ":", " ", 
      RowBox[{"use", " ", 
       RowBox[{"\[Psi]", "\[Conjugate]"}], 
       RowBox[{"(", 
        RowBox[{"x0", ",", 
         RowBox[{"p0", ";", "x"}]}], ")"}]}]}]}], "->", " ", 
    RowBox[{"\[Psi]", 
     RowBox[{"(", 
      RowBox[{"x0", ",", 
       RowBox[{
        RowBox[{"-", "p0"}], ";", "x"}]}], ")"}]}]}]}], "\[IndentingNewLine]",
   "*)"}]], "Input",
 CellChangeTimes->{{3.8858465037958655`*^9, 3.8858466873857985`*^9}, {
   3.8858467478913116`*^9, 3.8858467725655203`*^9}, {3.885847025307646*^9, 
   3.885847046090887*^9}, {3.8858495281743917`*^9, 3.88584953104941*^9}, {
   3.8858636304013147`*^9, 3.8858636855306535`*^9}, {3.8858637209777355`*^9, 
   3.885863722368061*^9}, {3.88586385653388*^9, 3.8858638640500765`*^9}, 
   3.8858640016350965`*^9, {3.886015593447544*^9, 3.8860156152610483`*^9}, {
   3.8860156500917745`*^9, 3.8860159319098063`*^9}, {3.886273262697235*^9, 
   3.886273270848762*^9}, {3.886273373504003*^9, 3.886273457779366*^9}, {
   3.8862735177245073`*^9, 3.8862735969959383`*^9}, {3.886273716788499*^9, 
   3.886273733138052*^9}, 3.8862738007458143`*^9, {3.886274005655397*^9, 
   3.886274012125661*^9}, {3.886274891487114*^9, 3.8862749294607964`*^9}, {
   3.886274972990527*^9, 3.886274988153091*^9}, 3.8862750371091423`*^9, {
   3.8870662460606537`*^9, 3.887066261870203*^9}, {3.8870663280051217`*^9, 
   3.887066353958898*^9}, {3.8870663880961065`*^9, 3.8870664148378353`*^9}, {
   3.887066445398137*^9, 3.8870665062005696`*^9}, {3.8870665449111595`*^9, 
   3.8870665693864527`*^9}, {3.887066614004654*^9, 3.8870666165549006`*^9}, {
   3.8870667519932075`*^9, 3.887066753747411*^9}, {3.8870669113111706`*^9, 
   3.887066918466962*^9}},ExpressionUUID->"8382252c-9feb-426e-9ca0-\
e61f18ca9ea9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"W2modes1s2", "[", 
    RowBox[{
    "t_", ",", "r_", ",", "\[Alpha]_", ",", "\[Theta]_", ",", "x1_", ",", 
     "p1_", ",", "x2_", ",", "p2_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Ws1s2", "[", " ", 
     RowBox[{
      RowBox[{"t", " ", "\[Alpha]"}], ",", "\[Theta]", ",", "x1", ",", "p1", 
      ",", "s1", ",", "s2"}], "]"}], 
    RowBox[{"Ws1s2", "[", 
     RowBox[{
      RowBox[{"r", " ", "\[Alpha]"}], ",", 
      RowBox[{"\[Theta]", "+", 
       FractionBox["\[Pi]", "2"]}], ",", "x2", ",", "p2", ",", "s1", ",", 
      "s2"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.887066940456647*^9, 3.887066956781352*^9}, {
  3.887066991682326*^9, 3.887067036413204*^9}, {3.887067099300669*^9, 
  3.887067163352674*^9}, {3.887067208293872*^9, 3.887067209579935*^9}, {
  3.887067397879633*^9, 3.8870674045898123`*^9}, {3.8870695290206804`*^9, 
  3.8870695392089214`*^9}, {3.887070109006217*^9, 3.8870701779871607`*^9}, {
  3.887075149307367*^9, 3.88707517361551*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"bf534aaa-e43b-4a13-b9c3-2a90fc3aa090"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"++", " ", 
    RowBox[{"and", " ", "--"}]}], " ", "terms", " ", "for", " ", "two", " ", 
   "modes"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8870711190937815`*^9, 
  3.8870711330438795`*^9}},ExpressionUUID->"db5dcab2-a578-40d9-a24d-\
334c9dae7819"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"W2modes1s2", "[", 
   RowBox[{
   "t", ",", "r", ",", "\[Alpha]", ",", "\[Theta]", ",", "x1", ",", "p1", ",",
     "x2", ",", "p2", ",", "1", ",", "1"}], "]"}], "+", 
  RowBox[{"W2modes1s2", "[", 
   RowBox[{
   "t", ",", "r", ",", "\[Alpha]", ",", "\[Theta]", ",", "x1", ",", "p1", ",",
     "x2", ",", "p2", ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8870672252269983`*^9, 3.8870672361138964`*^9}, {
  3.8870673000349827`*^9, 3.887067305500188*^9}, {3.887067366144375*^9, 
  3.8870673720758944`*^9}, {3.887067410818058*^9, 3.8870674248532734`*^9}, {
  3.8870675500283475`*^9, 3.887067556376499*^9}, {3.8870676067728357`*^9, 
  3.887067611354828*^9}, {3.887070154701103*^9, 3.887070163503683*^9}, {
  3.8870702873042603`*^9, 3.887070315030164*^9}, {3.887070821158004*^9, 
  3.8870708251144524`*^9}, {3.8870751847912493`*^9, 3.88707519181701*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"be4b164a-feed-4f67-9542-c75a5962b066"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p1", "2"]}], "-", 
     SuperscriptBox["p2", "2"], "-", 
     SuperscriptBox["x1", "2"], "-", 
     SuperscriptBox["x2", "2"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox["\[Alpha]", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["t", "2"], " ", 
      SuperscriptBox["\[Alpha]", "2"]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x1", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{"p1", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p2", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
        RowBox[{"x2", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], 
   SuperscriptBox["\[Pi]", "2"]], "+", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p1", "2"]}], "-", 
     SuperscriptBox["p2", "2"], "-", 
     SuperscriptBox["x1", "2"], "-", 
     SuperscriptBox["x2", "2"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox["\[Alpha]", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["t", "2"], " ", 
      SuperscriptBox["\[Alpha]", "2"]}], "-", 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x1", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{"p1", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p2"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{"x2", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], 
   SuperscriptBox["\[Pi]", "2"]]}]], "Output",
 CellChangeTimes->{3.8940660952834873`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"05570418-b9d1-4ec3-a83b-3576713a3429"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p1", "2"]}], "-", 
     SuperscriptBox["p2", "2"], "-", 
     SuperscriptBox["x1", "2"], "-", 
     SuperscriptBox["x2", "2"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox["\[Alpha]", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["t", "2"], " ", 
      SuperscriptBox["\[Alpha]", "2"]}]}]], 
   SuperscriptBox["\[Pi]", "2"]], 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"+", "2"}], " ", 
       SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"p1", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p2", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{"x2", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"p1", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "p2"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"x2", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]]}], ")"}]}]], \
"Input",
 CellChangeTimes->{{3.8940661699635177`*^9, 
  3.894066213484411*^9}},ExpressionUUID->"1686e94d-cc0c-4fce-af3d-\
fea5ebb02cf4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"+", "2"}], " ", 
       SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"p1", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p2", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{"x2", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"p1", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "p2"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"x2", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      SuperscriptBox["t", "2"]}], "==", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894066239855558*^9, 3.8940662623549566`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"0ddb1a5d-659d-438e-817a-e2a78594e50d"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"Cosh", "[", 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", "\[Alpha]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p2", " ", "r"}], "+", 
         RowBox[{"t", " ", "x1"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p1", " ", "t"}], "-", 
         RowBox[{"r", " ", "x2"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.894066266650959*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"5c5ef412-1f77-4d0b-bfc5-1007f3ab8059"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"final", " ", "form", " ", 
    SubscriptBox["w", "++"]}], "+", 
   SubscriptBox["w", "--"]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.887071166945118*^9, 
  3.8870711944380713`*^9}},ExpressionUUID->"25983487-f96c-4105-ab89-\
f73120bbfcbb"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p1", "2"]}], "-", 
     SuperscriptBox["p2", "2"], "-", 
     SuperscriptBox["x1", "2"], "-", 
     SuperscriptBox["x2", "2"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[Alpha]", "2"]}]}]], 
   SuperscriptBox["\[Pi]", "2"]], "2", " ", 
  RowBox[{"Cosh", "[", 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", "\[Alpha]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p2", " ", "r"}], "+", 
         RowBox[{"t", " ", "x1"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p1", " ", "t"}], "-", 
         RowBox[{"r", " ", "x2"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.8870712080007043`*^9, {3.8870766135993953`*^9, 3.887076661156703*^9}, 
   3.894066395159371*^9},ExpressionUUID->"e8dfcd0d-62f1-42ab-bf40-\
d83803136f3f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"+", 
    RowBox[{"-", " ", "and"}]}], " ", "-", 
   RowBox[{
    RowBox[{"+", " ", "terms"}], " ", "for", " ", "two", " ", "modes"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.88707113628026*^9, 
  3.887071150802662*^9}},ExpressionUUID->"4175f127-7c24-4af0-8709-\
75adf1e4fc82"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"W2modes1s2", "[", 
   RowBox[{
   "t", ",", "r", ",", "\[Alpha]", ",", "\[Theta]", ",", "x1", ",", "p1", ",",
     "x2", ",", "p2", ",", "1", ",", 
    RowBox[{"-", "1"}]}], "]"}], "+", 
  RowBox[{"W2modes1s2", "[", 
   RowBox[{
   "t", ",", "r", ",", "\[Alpha]", ",", "\[Theta]", ",", "x1", ",", "p1", ",",
     "x2", ",", "p2", ",", 
    RowBox[{"-", "1"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8870711560339837`*^9, 3.887071158453337*^9}, {
  3.8870766744659605`*^9, 3.887076678971755*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"d0485b60-956a-4992-b82a-a8f008936b6a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p1", "2"]}], "-", 
     SuperscriptBox["p2", "2"], "-", 
     SuperscriptBox["x1", "2"], "-", 
     SuperscriptBox["x2", "2"], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x2", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{"p2", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p1", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
        RowBox[{"x1", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], 
   SuperscriptBox["\[Pi]", "2"]], "+", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p1", "2"]}], "-", 
     SuperscriptBox["p2", "2"], "-", 
     SuperscriptBox["x1", "2"], "-", 
     SuperscriptBox["x2", "2"], "-", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x2", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{"p2", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p1", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
        RowBox[{"x1", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], 
   SuperscriptBox["\[Pi]", "2"]]}]], "Output",
 CellChangeTimes->{3.894066416567915*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"9e8a522e-3a49-4f10-8a43-d9605357ef30"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p1", "2"]}], "-", 
     SuperscriptBox["p2", "2"], "-", 
     SuperscriptBox["x1", "2"], "-", 
     SuperscriptBox["x2", "2"]}]], 
   SuperscriptBox["\[Pi]", "2"]], 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"+", "2"}], " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"p2", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p1", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{"x1", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"p2", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p1", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{"x1", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.8940664341063237`*^9, 
  3.8940664583315616`*^9}},ExpressionUUID->"fd917406-5ed6-4d07-92e5-\
94ae4fc0050a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"+", "2"}], " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"p2", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p1", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{"x1", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x2", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"p2", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p1", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
         RowBox[{"x1", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      SuperscriptBox["t", "2"]}], "==", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8940664766373796`*^9, 3.8940664808329554`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"c8ae3f7b-e0eb-47ea-8998-ab6d3efc8fe1"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", "\[Alpha]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "p1"}], " ", "t"}], "+", 
         RowBox[{"r", " ", "x2"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p2", " ", "r"}], "+", 
         RowBox[{"t", " ", "x1"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.894066485066431*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"6b5346e1-7256-4c04-95df-f70c60b09f9b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"final", " ", "form", " ", 
    SubscriptBox["w", 
     RowBox[{"+", "-"}]]}], "+", 
   SubscriptBox["w", 
    RowBox[{"-", "+"}]]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.887071166945118*^9, 3.8870711944380713`*^9}, {
  3.887071454473884*^9, 
  3.88707146992292*^9}},ExpressionUUID->"39fca8ca-f065-4e45-9d0f-\
11ac9141155c"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["p1", "2"]}], "-", 
     SuperscriptBox["p2", "2"], "-", 
     SuperscriptBox["x1", "2"], "-", 
     SuperscriptBox["x2", "2"]}]], 
   SuperscriptBox["\[Pi]", "2"]], "2", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", "\[Alpha]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "p1"}], " ", "t"}], "+", 
         RowBox[{"r", " ", "x2"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p2", " ", "r"}], "+", 
         RowBox[{"t", " ", "x1"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.8870712080007043`*^9, 3.8870714508107777`*^9, 
  3.8870718300240297`*^9, 3.887076820974142*^9, 
  3.894066551504919*^9},ExpressionUUID->"dcf24c98-d278-4e45-91df-\
1f6791a6a46a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"General", " ", "cat", " ", "two", " ", "mode", " ", "B"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", " ", 
        RowBox[{"\[ImaginaryI]", " ", "r"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "r"}], ",", " ", "t"}], "}"}]}], 
     "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Two", "-", 
    RowBox[{
    "mode", " ", "Wigner", " ", "distribution", " ", "just", " ", "before", 
     " ", "heralding"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"W2mode", "[", 
      RowBox[{
      "t_", ",", "r_", ",", "\[Alpha]_", ",", "\[Theta]_", ",", "x1_", ",", 
       "p1_", ",", "x2_", ",", "p2_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["p1", "2"]}], "-", 
         SuperscriptBox["p2", "2"], "-", 
         SuperscriptBox["x1", "2"], "-", 
         SuperscriptBox["x2", "2"]}]], 
       RowBox[{
        SuperscriptBox["\[Pi]", "2"], " ", "2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"s", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["\[Alpha]", "2"]}]]}]}], ")"}]}]], "2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["\[Alpha]", "2"]}]], 
         RowBox[{"Cosh", "[", 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p2", " ", "r"}], "+", 
                RowBox[{"t", " ", "x1"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p1", " ", "t"}], "-", 
                RowBox[{"r", " ", "x2"}]}], ")"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}], 
        "+", 
        RowBox[{"s", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           SqrtBox["2"], " ", "\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "p1"}], " ", "t"}], "+", 
                RowBox[{"r", " ", "x2"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p2", " ", "r"}], "+", 
                RowBox[{"t", " ", "x1"}]}], ")"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}]}]}], 
       ")"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"W2mode", "[", 
     RowBox[{
     "t_", ",", "r_", ",", "\[Alpha]_", ",", "\[Theta]_", ",", "x1_", ",", 
      "p1_", ",", "x2_", ",", "p2_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"s", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            SuperscriptBox["\[Alpha]", "2"]}]]}]}], ")"}]}]], 
     FractionBox["1", 
      SuperscriptBox["\[Pi]", "2"]], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["p1", "2"]}], "-", 
         SuperscriptBox["p2", "2"], "-", 
         SuperscriptBox["x1", "2"], "-", 
         SuperscriptBox["x2", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x1", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"p1", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p2", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"x2", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["p1", "2"]}], "-", 
         SuperscriptBox["p2", "2"], "-", 
         SuperscriptBox["x1", "2"], "-", 
         SuperscriptBox["x2", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"]}], "-", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x1", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"p1", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "p2"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"x2", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["p1", "2"]}], "-", 
            SuperscriptBox["p2", "2"], "-", 
            SuperscriptBox["x1", "2"], "-", 
            SuperscriptBox["x2", "2"], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{"p2", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p1", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"x1", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]]}], "+", 
         RowBox[{"s", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["p1", "2"]}], "-", 
            SuperscriptBox["p2", "2"], "-", 
            SuperscriptBox["x1", "2"], "-", 
            SuperscriptBox["x2", "2"], "-", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{"p2", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p1", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"x1", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]]}]}], 
        ")"}]}], ")"}]}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8858498985611196`*^9, 3.8858499382036123`*^9}, {
   3.8858499784703665`*^9, 3.885850009270121*^9}, 3.8858626015302057`*^9, {
   3.8858641575062723`*^9, 3.8858641589281054`*^9}, {3.886015631294325*^9, 
   3.8860156396546593`*^9}, {3.887071480054124*^9, 3.8870715928897314`*^9}, {
   3.8870717676859903`*^9, 3.887071780421836*^9}, {3.8870718361029205`*^9, 
   3.8870718501833425`*^9}, {3.887072072743135*^9, 3.887072098281388*^9}, {
   3.8870721644669323`*^9, 3.8870721653694973`*^9}, 3.887072276870008*^9, {
   3.8870768410265875`*^9, 3.887076886909055*^9}, {3.8871613836296434`*^9, 
   3.8871615641035256`*^9}, {3.8871616544748106`*^9, 3.887161657475218*^9}, {
   3.8879343547930565`*^9, 3.8879343760626526`*^9}, {3.894066606574421*^9, 
   3.894066615859638*^9}, {3.894068398685341*^9, 3.894068536097412*^9}, 
   3.894068602193102*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"145e9982-de56-49fa-bc68-7abf719b7f20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Real", " ", "Variables"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GaussianIntegralMatrix", "[", "M_", "]"}], ":=", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
           SuperscriptBox[
            RowBox[{"M", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "2"]}], "-", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
           SuperscriptBox[
            RowBox[{"M", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"M", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "2"], " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
          RowBox[{"4", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "2"], "-", 
          RowBox[{"4", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}]}]]], " ", 
       "\[Pi]"}], 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "2"], 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]]}]], " ", 
       SqrtBox[
        RowBox[{"-", 
         RowBox[{"M", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}]]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpCoefficientsToMatrix", "[", 
      RowBox[{"expr_", ",", "x_", ",", "p_"}], "]"}], ":=", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"expr", ",", "\[ExponentialE]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "p"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GaussIntR1", "[", 
      RowBox[{"expr_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "expo"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"expo", " ", "=", " ", 
         RowBox[{"Exponent", "[", 
          RowBox[{"expr", ",", "\[ExponentialE]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"expr", ",", "\[ExponentialE]", ",", " ", "expo"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
         RowBox[{"CoefficientList", "[", 
          RowBox[{"expo", ",", "x", ",", "3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        FractionBox[
         RowBox[{"d", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox["b", "2"], 
              RowBox[{"4", " ", "a"}]]}], "+", "c"}]], " ", 
          SqrtBox["\[Pi]"]}], 
         SqrtBox[
          RowBox[{"-", "a"}]]]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GaussIntR2", "[", 
      RowBox[{"expr_", ",", "var1_", ",", "var2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"expo", ",", "coef"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"expo", " ", "=", " ", 
         RowBox[{"Exponent", "[", 
          RowBox[{"expr", ",", "\[ExponentialE]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coef", " ", "=", " ", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"expr", ",", "\[ExponentialE]", ",", " ", "expo"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"coef", " ", 
         RowBox[{"GaussianIntegralMatrix", "[", 
          RowBox[{"CoefficientList", "[", 
           RowBox[{"expo", ",", 
            RowBox[{"{", 
             RowBox[{"var1", ",", "var2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Trunated", " ", "Gaussian", " ", 
     RowBox[{"integrals", ":", " ", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        RowBox[{
         RowBox[{"-", "\[CapitalDelta]"}], "/", "2"}], 
        RowBox[{"\[CapitalDelta]", "/", "2"}]], 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            SuperscriptBox["x", "2"]}], "+", 
           RowBox[{"b", " ", "x"}], " ", "+", "a"}], ")"}]], 
        RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "TruncatedGaussInt", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TruncatedGaussInt", "[", 
      RowBox[{"expr_", ",", "x_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "expo", ",", "coef"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"expo", "=", 
         RowBox[{"Exponent", "[", 
          RowBox[{"expr", ",", "\[ExponentialE]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"expr", ",", "\[ExponentialE]", ",", "expo"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
         RowBox[{"CoefficientList", "[", 
          RowBox[{"expo", ",", 
           RowBox[{"{", "x", "}"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Simplify", "[", 
         RowBox[{"d", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                SuperscriptBox["b", "2"], 
                RowBox[{"4", " ", "a"}]]}], "+", "c"}]], " ", 
            SqrtBox["\[Pi]"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Erfi", "[", 
                FractionBox[
                 RowBox[{"b", "-", 
                  RowBox[{"a", " ", "\[CapitalDelta]"}]}], 
                 RowBox[{"2", " ", 
                  SqrtBox["a"]}]], "]"}]}], "+", 
              RowBox[{"Erfi", "[", 
               FractionBox[
                RowBox[{"b", "+", 
                 RowBox[{"a", " ", "\[CapitalDelta]"}]}], 
                RowBox[{"2", " ", 
                 SqrtBox["a"]}]], "]"}]}], ")"}]}], 
           RowBox[{"2", " ", 
            SqrtBox["a"]}]]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.891051474173073*^9, 3.891051500099601*^9}, {
   3.891051531178793*^9, 3.891051875740218*^9}, {3.891051928241543*^9, 
   3.891052035657254*^9}, {3.891052162890197*^9, 3.891052303903112*^9}, {
   3.891052836406435*^9, 3.891052925938027*^9}, {3.891053019710294*^9, 
   3.891053050793953*^9}, {3.891053143390341*^9, 3.891053260123448*^9}, {
   3.891053291823152*^9, 3.891053326467146*^9}, {3.891053417341216*^9, 
   3.8910534798884974`*^9}, {3.8910535312580643`*^9, 
   3.8910535660663853`*^9}, {3.891053602558671*^9, 3.891053637916566*^9}, {
   3.891053973095109*^9, 3.891054095209445*^9}, {3.891054201219017*^9, 
   3.8910542261568003`*^9}, {3.891054386254147*^9, 3.891054396413319*^9}, {
   3.891054479085239*^9, 3.891054539898569*^9}, {3.891054580347865*^9, 
   3.891054582479888*^9}, {3.8910546638684196`*^9, 3.891054680585456*^9}, {
   3.891054711691704*^9, 3.89105473271989*^9}, {3.891054776004319*^9, 
   3.8910549153378468`*^9}, {3.8910549790078697`*^9, 
   3.8910550236007957`*^9}, {3.891055055252842*^9, 3.891055158209025*^9}, {
   3.891055216056715*^9, 3.8910552347964582`*^9}, {3.8910558209774647`*^9, 
   3.8910560333592787`*^9}, {3.891056063851841*^9, 3.891056100796818*^9}, {
   3.891056174632102*^9, 3.891056467309984*^9}, 3.8910566911669807`*^9, 
   3.891057257595378*^9, 3.891057304085327*^9, {3.891658056326274*^9, 
   3.891658072507659*^9}, {3.8920877959125347`*^9, 3.8920878011514797`*^9}, {
   3.892157534563236*^9, 3.892157545873816*^9}, {3.89216736770179*^9, 
   3.8921675611978283`*^9}, {3.892255190048388*^9, 3.892255206553677*^9}, {
   3.892782069103449*^9, 3.8927820828646545`*^9}, {3.8927822028012867`*^9, 
   3.892782312151314*^9}, {3.8927823614335566`*^9, 3.892782404761662*^9}, {
   3.8940667505859528`*^9, 3.894066751010428*^9}, {3.8940668124804153`*^9, 
   3.8940668266509027`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"ac189b93-1e4c-4aea-a04e-249497ddd0cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[Calc] \[Delta] Gaussian filtering", "Subsubsection",
 CellChangeTimes->{{3.8870739272025356`*^9, 3.887073932996043*^9}, {
   3.888024797175744*^9, 3.8880248133641863`*^9}, {3.888035945502914*^9, 
   3.8880359589588785`*^9}, {3.8882697092097187`*^9, 3.8882697128501005`*^9}, 
   3.888370128532089*^9, {3.8940701027798185`*^9, 
   3.894070104263889*^9}},ExpressionUUID->"61932443-88a0-496e-beff-\
ac700df8687a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"\[Pi]", " ", "2", "\[Delta]"}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{" ", "1"}], 
        RowBox[{"2", "\[Delta]"}]]}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["x2", "2"], "-", 
        RowBox[{"2", "x", " ", "x2"}], "+", 
        SuperscriptBox["p", "2"], "+", 
        SuperscriptBox["p2", "2"], "-", 
        RowBox[{"2", "p", " ", "p2"}]}], ")"}]}]]}], ")"}], 
  RowBox[{"W2mode", "[", 
   RowBox[{
   "t", ",", "r", ",", "\[Alpha]", ",", "\[Theta]", ",", "x1", ",", "p1", ",",
     "x", ",", "p", ",", "s"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.89406831377479*^9, 3.894068314698829*^9}, {
  3.8940698595981145`*^9, 3.894069875992489*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"e347eced-57d3-4f18-adf3-0e7ee691f5dd"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox["\[Pi]", "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["\[Alpha]", "2"]}]], " ", "s"}]}], ")"}], " ", 
    "\[Delta]"}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["p", "2"], "-", 
       RowBox[{"2", " ", "p", " ", "p2"}], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["x", "2"], "-", 
       RowBox[{"2", " ", "x", " ", "x2"}], "+", 
       SuperscriptBox["x2", "2"]}], 
      RowBox[{"2", " ", "\[Delta]"}]]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["p", "2"]}], "-", 
       SuperscriptBox["p1", "2"], "-", 
       SuperscriptBox["x", "2"], "-", 
       SuperscriptBox["x1", "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox["\[Alpha]", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["t", "2"], " ", 
        SuperscriptBox["\[Alpha]", "2"]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"p1", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"x", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["p", "2"]}], "-", 
       SuperscriptBox["p1", "2"], "-", 
       SuperscriptBox["x", "2"], "-", 
       SuperscriptBox["x1", "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["r", "2"], " ", 
        SuperscriptBox["\[Alpha]", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["t", "2"], " ", 
        SuperscriptBox["\[Alpha]", "2"]}], "-", 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x1", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"p1", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "p"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"x", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["p", "2"]}], "-", 
        SuperscriptBox["p1", "2"], "-", 
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["x1", "2"], "+", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", 
         SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"p", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", 
         SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
           RowBox[{"x1", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], " ", "s"}],
      "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["p", "2"]}], "-", 
        SuperscriptBox["p1", "2"], "-", 
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["x1", "2"], "-", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", 
         SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"p", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", 
         SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p1", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
           RowBox[{"x1", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], " ", 
      "s"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.8940677798524523`*^9, 3.894068319088359*^9, 
  3.8940686108157387`*^9, 3.894069883087805*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"9da506de-5584-4291-ab0d-66e4d93fd50f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"GaussFiltered", " ", "=", "  ", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", " ", "\[Pi]", " ", "\[Delta]"}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{" ", "1"}], 
            RowBox[{"2", " ", "\[Delta]"}]]}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["x2", "2"], "-", 
            RowBox[{"2", "x", " ", "x2"}], "+", 
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["p2", "2"], "-", 
            RowBox[{"2", "p", " ", "p2"}]}], ")"}]}]]}], ")"}], 
      RowBox[{"W2mode", "[", 
       RowBox[{
       "t", ",", "r", ",", "\[Alpha]", ",", "\[Theta]", ",", "x1", ",", "p1", 
        ",", "x", ",", "p", ",", "s"}], "]"}], 
      RowBox[{"\[DifferentialD]", "p"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8870739438509665`*^9, 3.887073982284957*^9}, 
   3.887083826581899*^9, {3.8870839432278705`*^9, 3.887083971590612*^9}, {
   3.887160687133919*^9, 3.8871607177282686`*^9}, {3.8871607932181687`*^9, 
   3.8871608313741035`*^9}, {3.8878582625086465`*^9, 3.887858270088859*^9}, {
   3.887858362362034*^9, 3.8878583924353924`*^9}, {3.8879343791913447`*^9, 
   3.8879344218286476`*^9}, {3.888024517724218*^9, 3.8880245370545545`*^9}, {
   3.8880245941696377`*^9, 3.888024600185639*^9}, {3.888024684557127*^9, 
   3.888024687354004*^9}, {3.8880247826103153`*^9, 3.888024783032591*^9}, {
   3.8880253990967245`*^9, 3.8880254459792805`*^9}, {3.8880320780341744`*^9, 
   3.8880320989900694`*^9}, {3.8880322113783703`*^9, 3.8880322570128517`*^9}, 
   3.8880327391595917`*^9, 3.88803277646253*^9, {3.888032834688569*^9, 
   3.8880329422485304`*^9}, {3.888033235008885*^9, 3.8880332358373775`*^9}, {
   3.888033627502653*^9, 3.8880336461146803`*^9}, {3.888034389888707*^9, 
   3.8880343933414593`*^9}, {3.894068685614186*^9, 3.894068710059433*^9}, {
   3.894069892558979*^9, 
   3.894069914855669*^9}},ExpressionUUID->"b85ad3bb-c7b4-4e7c-947a-\
173f82583d82"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"integrandsun", " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     RowBox[{" ", 
      RowBox[{
       SuperscriptBox["\[Pi]", "3"], "  ", "2", "\[Delta]"}]}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["p", "2"], "-", 
        RowBox[{"2", " ", "p", " ", "p2"}], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["x", "2"], "-", 
        RowBox[{"2", " ", "x", " ", "x2"}], "+", 
        SuperscriptBox["x2", "2"]}], 
       RowBox[{"2", "\[Delta]"}]]}]], " ", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["p", "2"]}], "-", 
        SuperscriptBox["p1", "2"], "-", 
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["x1", "2"], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Alpha]", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["\[Alpha]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"p1", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
           RowBox[{"x", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], ",", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["p", "2"]}], "-", 
        SuperscriptBox["p1", "2"], "-", 
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["x1", "2"], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["r", "2"], " ", 
         SuperscriptBox["\[Alpha]", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["\[Alpha]", "2"]}], "-", 
        RowBox[{"2", " ", 
         SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"p1", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "p"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"x", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], ",", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["p", "2"]}], "-", 
         SuperscriptBox["p1", "2"], "-", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["x1", "2"], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"p", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p1", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"x1", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], " ", 
       "s"}], ",", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["p", "2"]}], "-", 
         SuperscriptBox["p1", "2"], "-", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["x1", "2"], "-", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"p", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p1", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"x1", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}]], " ", 
       "s"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"integralsun", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"GaussIntR2", "[", 
       RowBox[{"#", ",", " ", "x", ",", "p"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         SuperscriptBox["t", "2"]}], "==", "1"}], "}"}]}], "]"}], "&"}], "/@",
    "integrandsun"}]}]}], "Input",
 CellChangeTimes->{{3.894068899930124*^9, 3.8940689157251277`*^9}, {
  3.894068946280428*^9, 3.894069047768222*^9}, {3.8940690834363613`*^9, 
  3.8940690966253815`*^9}, {3.8940691355204563`*^9, 3.8940691558818455`*^9}, {
  3.8940691965365553`*^9, 3.894069207841447*^9}, {3.8940694163007116`*^9, 
  3.8940694668675303`*^9}, {3.894069845486579*^9, 3.894069847832346*^9}, {
  3.8940699392170715`*^9, 3.894069969559843*^9}, {3.8940700243737345`*^9, 
  3.8940700267950583`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"b0396cb0-7a39-4666-b409-fdcb4c0ce67b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["x1", "2"], "+", 
        SuperscriptBox["x2", "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Alpha]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["p1", "2"], " ", "\[Delta]"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["x1", "2"], " ", "\[Delta]"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "-", 
        RowBox[{"2", " ", 
         SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "\[Delta]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"p1", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "p2"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"x2", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Delta]"}]}]]}]], 
    RowBox[{
     SuperscriptBox["\[Pi]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Delta]"}]}], ")"}]}]], ",", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["x1", "2"], "+", 
        SuperscriptBox["x2", "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Alpha]", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["p1", "2"], " ", "\[Delta]"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["x1", "2"], " ", "\[Delta]"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["t", "2"], " ", 
         SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "\[Delta]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"p1", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p2", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
           RowBox[{"x2", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[Delta]"}]}]]}]], 
    RowBox[{
     SuperscriptBox["\[Pi]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Delta]"}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["x1", "2"], "+", 
         SuperscriptBox["x2", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["p1", "2"], " ", "\[Delta]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["x1", "2"], " ", "\[Delta]"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "-", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x2", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"p2", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[Delta]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p1", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"x1", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Delta]"}]}]]}]], " ", "s"}], 
    RowBox[{
     SuperscriptBox["\[Pi]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Delta]"}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["x1", "2"], "+", 
         SuperscriptBox["x2", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["p1", "2"], " ", "\[Delta]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["x1", "2"], " ", "\[Delta]"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["t", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x2", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"p2", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", 
          SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[Delta]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p1", " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
            RowBox[{"x1", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Delta]"}]}]]}]], " ", "s"}], 
    RowBox[{
     SuperscriptBox["\[Pi]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", "\[Delta]"}]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.8940690213622246`*^9, 3.8940690351628957`*^9}, 
   3.894069071578619*^9, 3.8940691248304014`*^9, 3.8940691908476334`*^9, 
   3.8940692409916267`*^9, 3.894069432652134*^9, 3.894069469460743*^9, 
   3.894070003576869*^9, 3.894070058637834*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"b1dfa5a3-9dc7-432d-ad15-7de091d60aaf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Checking", " ", "normalization"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"GaussIntR2", "[", 
        RowBox[{
         RowBox[{"GaussIntR2", "[", 
          RowBox[{"#", ",", " ", "x2", ",", "p2"}], "]"}], ",", "x1", ",", 
         "p1"}], "]"}], "&"}], "/@", "integralsun"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       SuperscriptBox["t", "2"]}], "==", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.894069525423045*^9, 3.8940695736720176`*^9}, {
  3.8940696778009853`*^9, 3.8940696801284914`*^9}, {3.8940697289480066`*^9, 
  3.894069738597514*^9}, {3.8940697728687963`*^9, 3.894069787339446*^9}, {
  3.894070061530551*^9, 3.89407006168668*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"2ebfc636-2ebe-409c-bb19-68360c41d7b7"],

Cell[BoxData[
 RowBox[{"2", "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["\[Alpha]", "2"]}]], " ", "s"}]}]], "Output",
 CellChangeTimes->{3.894069692688238*^9, 3.8940697413780537`*^9, 
  3.894070073146847*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"9d4c3338-af6e-4e20-97cc-8115619f76ab"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["[Rslt] \[Delta] Gaussian Filtered 2 mode normalized Wigner", \
"Subsubsection",
 CellChangeTimes->{{3.888270174342517*^9, 3.888270209714787*^9}, {
  3.890779185722034*^9, 3.8907792020756955`*^9}, {3.894070167315307*^9, 
  3.8940701676121836`*^9}},ExpressionUUID->"e5b0358a-4774-4f93-9542-\
0a99a38178ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[Pi]", " ", "\[Delta]"}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{" ", "1"}], 
            RowBox[{"2", " ", "\[Delta]"}]]}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["x2", "2"], "-", 
            RowBox[{"2", "x", " ", "x2"}], "+", 
            SuperscriptBox["p", "2"], "+", 
            SuperscriptBox["p2", "2"], "-", 
            RowBox[{"2", "p", " ", "p2"}]}], ")"}]}]]}], ")"}], 
      RowBox[{"W2mode", "[", 
       RowBox[{
       "t", ",", "r", ",", "\[Alpha]", ",", "\[Theta]", ",", "x1", ",", "p1", 
        ",", "x", ",", "p", ",", "s"}], "]"}], 
      RowBox[{"\[DifferentialD]", "p"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Wn", "[", 
     RowBox[{
     "\[Delta]_", ",", "t_", ",", "r_", ",", "\[Alpha]_", ",", "\[Theta]_", 
      ",", "x1_", ",", "p1_", ",", "x2_", ",", "p2_", ",", "s_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"s", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            SuperscriptBox["\[Alpha]", "2"]}]]}]}], ")"}], 
       SuperscriptBox["\[Pi]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "\[Delta]"}]}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["p1", "2"], "+", 
           SuperscriptBox["p2", "2"], "+", 
           SuperscriptBox["x1", "2"], "+", 
           SuperscriptBox["x2", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Alpha]", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["p1", "2"], " ", "\[Delta]"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["x1", "2"], " ", "\[Delta]"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["t", "2"], " ", 
            SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "-", 
           RowBox[{"2", " ", 
            SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", "\[Delta]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x1", " ", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
              RowBox[{"p1", " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "p2"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
              RowBox[{"x2", " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "\[Delta]"}]}]]}]], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["p1", "2"], "+", 
           SuperscriptBox["p2", "2"], "+", 
           SuperscriptBox["x1", "2"], "+", 
           SuperscriptBox["x2", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Alpha]", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["p1", "2"], " ", "\[Delta]"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["x1", "2"], " ", "\[Delta]"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["t", "2"], " ", 
            SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "+", 
           RowBox[{"2", " ", 
            SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", " ", "\[Delta]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x1", " ", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
              RowBox[{"p1", " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p2", " ", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
              RowBox[{"x2", " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "\[Delta]"}]}]]}]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["p1", "2"], "+", 
            SuperscriptBox["p2", "2"], "+", 
            SuperscriptBox["x1", "2"], "+", 
            SuperscriptBox["x2", "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["p1", "2"], " ", "\[Delta]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["x1", "2"], " ", "\[Delta]"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["t", "2"], " ", 
             SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "-", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{"p2", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", "\[Delta]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p1", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"x1", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[Delta]"}]}]]}]], " ", "s"}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["p1", "2"], "+", 
            SuperscriptBox["p2", "2"], "+", 
            SuperscriptBox["x1", "2"], "+", 
            SuperscriptBox["x2", "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["p1", "2"], " ", "\[Delta]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["x1", "2"], " ", "\[Delta]"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["t", "2"], " ", 
             SuperscriptBox["\[Alpha]", "2"], " ", "\[Delta]"}], "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SqrtBox["2"], " ", "r", " ", "\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
               RowBox[{"p2", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "-", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", 
             SqrtBox["2"], " ", "t", " ", "\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", "\[Delta]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p1", " ", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
               RowBox[{"x1", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[Delta]"}]}]]}]], " ", "s"}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.885858601052227*^9, 3.885858606380412*^9}, {
   3.8858588139095893`*^9, 3.885858921743759*^9}, {3.8858614435946646`*^9, 
   3.8858615101443844`*^9}, {3.885864494562831*^9, 3.8858644992670507`*^9}, {
   3.8858645900818377`*^9, 3.8858645972692986`*^9}, {3.8858647498851285`*^9, 
   3.8858647614477587`*^9}, {3.885865959947753*^9, 3.885865966276557*^9}, {
   3.8860155148324394`*^9, 3.8860155338650274`*^9}, {3.8860160121049967`*^9, 
   3.886016036715518*^9}, {3.8870730780697813`*^9, 3.8870731073924627`*^9}, {
   3.8870780121613855`*^9, 3.887078018770446*^9}, 3.88707814623234*^9, 
   3.887084172918634*^9, {3.8870844772673545`*^9, 3.8870845029117365`*^9}, {
   3.887087543418458*^9, 3.887087562467306*^9}, 3.887859288733055*^9, 
   3.887859327421424*^9, {3.887918667891285*^9, 3.8879187585450087`*^9}, {
   3.8879344546628036`*^9, 3.88793446200392*^9}, {3.888024971140682*^9, 
   3.888024974109414*^9}, {3.8880351735299244`*^9, 3.8880351927984776`*^9}, {
   3.88803523205424*^9, 3.888035303394564*^9}, {3.8882702051862955`*^9, 
   3.888270205562561*^9}, 3.888270254836689*^9, 3.888270333316744*^9, {
   3.888270637086328*^9, 3.8882706645788536`*^9}, {3.8940702093041687`*^9, 
   3.8940702250267253`*^9}, {3.894070257687482*^9, 3.8940702585622854`*^9}, {
   3.8940703590606585`*^9, 
   3.8940704029064274`*^9}},ExpressionUUID->"c969b26b-b0c0-4cdf-abb9-\
9c924ba20e53"]
}, Open  ]]
},
WindowSize->{1920, 989},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.4 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"51528fe7-c435-4617-9bfd-b0d97ef2cac2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 387, 8, 78, "Subsubsection",ExpressionUUID->"f2aa224e-304c-4038-8ad3-777e6eb4da94"],
Cell[970, 32, 1596, 51, 152, "Text",ExpressionUUID->"46b17cec-0e35-4f06-a977-0f19b218036d"],
Cell[CellGroupData[{
Cell[2591, 87, 3887, 102, 297, "Input",ExpressionUUID->"50b1cce2-e8e2-40fc-a557-9cef5648ed5f"],
Cell[6481, 191, 997, 24, 91, "Output",ExpressionUUID->"7d50bf4c-d6b9-4598-9bd8-45f07d8acafb"],
Cell[7481, 217, 997, 24, 91, "Output",ExpressionUUID->"ae6fc8dc-73ff-4c95-9a78-1bdaa31b4887"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8515, 246, 1379, 28, 85, "Input",ExpressionUUID->"3fe25f4f-508b-4882-88fe-1adf628f284a"],
Cell[9897, 276, 1041, 26, 94, "Output",ExpressionUUID->"e9010df4-fc11-4eb6-91ee-03296a595ce5"],
Cell[10941, 304, 969, 24, 94, "Output",ExpressionUUID->"1cb837f3-40a3-47ac-9708-6c9651d0e735"]
}, Open  ]],
Cell[11925, 331, 2005, 58, 125, "Input",ExpressionUUID->"354ff959-f72f-4056-b5ac-6a6edfd5dcfb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13967, 394, 497, 9, 78, "Subsubsection",ExpressionUUID->"7990f718-9d32-43ed-a38e-8388a77ea3ed"],
Cell[14467, 405, 3162, 67, 265, "Input",ExpressionUUID->"8382252c-9feb-426e-9ca0-e61f18ca9ea9"],
Cell[17632, 474, 1126, 24, 74, "Input",ExpressionUUID->"bf534aaa-e43b-4a13-b9c3-2a90fc3aa090"],
Cell[18761, 500, 313, 8, 50, "Input",ExpressionUUID->"db5dcab2-a578-40d9-a24d-334c9dae7819"],
Cell[CellGroupData[{
Cell[19099, 512, 1021, 19, 50, "Input",ExpressionUUID->"be4b164a-feed-4f67-9542-c75a5962b066"],
Cell[20123, 533, 2338, 66, 94, "Output",ExpressionUUID->"05570418-b9d1-4ec3-a83b-3576713a3429"]
}, Open  ]],
Cell[22476, 602, 2071, 61, 96, InheritFromParent,ExpressionUUID->"1686e94d-cc0c-4fce-af3d-fea5ebb02cf4"],
Cell[CellGroupData[{
Cell[24572, 667, 1755, 49, 66, "Input",ExpressionUUID->"0ddb1a5d-659d-438e-817a-e2a78594e50d"],
Cell[26330, 718, 694, 20, 63, "Output",ExpressionUUID->"5c5ef412-1f77-4d0b-bfc5-1007f3ab8059"]
}, Open  ]],
Cell[27039, 741, 302, 8, 50, "Input",ExpressionUUID->"25983487-f96c-4105-ab89-f73120bbfcbb"],
Cell[27344, 751, 1094, 33, 96, "Input",ExpressionUUID->"e8dfcd0d-62f1-42ab-bf40-d83803136f3f"],
Cell[28441, 786, 344, 10, 50, "Input",ExpressionUUID->"4175f127-7c24-4af0-8709-75adf1e4fc82"],
Cell[CellGroupData[{
Cell[28810, 800, 623, 14, 50, "Input",ExpressionUUID->"d0485b60-956a-4992-b82a-a8f008936b6a"],
Cell[29436, 816, 1963, 53, 94, "Output",ExpressionUUID->"9e8a522e-3a49-4f10-8a43-d9605357ef30"]
}, Open  ]],
Cell[31414, 872, 1919, 54, 96, "Input",ExpressionUUID->"fd917406-5ed6-4d07-92e5-94ae4fc0050a"],
Cell[CellGroupData[{
Cell[33358, 930, 1819, 48, 66, "Input",ExpressionUUID->"c8ae3f7b-e0eb-47ea-8998-ab6d3efc8fe1"],
Cell[35180, 980, 719, 21, 63, "Output",ExpressionUUID->"6b5346e1-7256-4c04-95df-f70c60b09f9b"]
}, Open  ]],
Cell[35914, 1004, 389, 11, 50, "Input",ExpressionUUID->"39fca8ca-f065-4e45-9d0f-11ac9141155c"],
Cell[36306, 1017, 1069, 32, 96, "Input",ExpressionUUID->"dcf24c98-d278-4e45-91df-1f6791a6a46a"],
Cell[37378, 1051, 9154, 231, 584, "Input",ExpressionUUID->"145e9982-de56-49fa-bc68-7abf719b7f20"],
Cell[46535, 1284, 10659, 248, 1121, "Input",ExpressionUUID->"ac189b93-1e4c-4aea-a04e-249497ddd0cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57231, 1537, 416, 6, 78, "Subsubsection",ExpressionUUID->"61932443-88a0-496e-beff-ac700df8687a"],
Cell[CellGroupData[{
Cell[57672, 1547, 949, 26, 80, "Input",ExpressionUUID->"e347eced-57d3-4f18-adf3-0e7ee691f5dd"],
Cell[58624, 1575, 5093, 138, 236, "Output",ExpressionUUID->"9da506de-5584-4291-ab0d-66e4d93fd50f"]
}, Open  ]],
Cell[63732, 1716, 2399, 50, 75, "Input",ExpressionUUID->"b85ad3bb-c7b4-4e7c-947a-173f82583d82"],
Cell[CellGroupData[{
Cell[66156, 1770, 5840, 150, 233, "Input",ExpressionUUID->"b0396cb0-7a39-4666-b409-fdcb4c0ce67b"],
Cell[71999, 1922, 7184, 186, 398, "Output",ExpressionUUID->"b1dfa5a3-9dc7-432d-ad15-7de091d60aaf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79220, 2113, 969, 24, 90, "Input",ExpressionUUID->"2ebfc636-2ebe-409c-bb19-68360c41d7b7"],
Cell[80192, 2139, 372, 9, 66, "Output",ExpressionUUID->"9d4c3338-af6e-4e20-97cc-8115619f76ab"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80613, 2154, 310, 5, 78, "Subsubsection",ExpressionUUID->"e5b0358a-4774-4f93-9542-0a99a38178ec"],
Cell[80926, 2161, 9910, 232, 497, "Input",ExpressionUUID->"c969b26b-b0c0-4cdf-abb9-9c924ba20e53"]
}, Open  ]]
}
]
*)

